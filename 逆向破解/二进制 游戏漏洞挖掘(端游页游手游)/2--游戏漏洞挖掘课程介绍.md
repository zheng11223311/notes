### 1.游戏漏洞挖掘课程介绍

游戏漏洞因为自身的特殊性,他的挖掘思想即继承常规漏洞挖掘,又不同与常规漏洞挖掘,就可以简单归纳为如下3条:

1. 信息的输入输出是存在漏洞的高风险地方

2. 一切在客户端的逻辑一定不安全

3. 一切在服务端的逻辑一定不安全

   网络游戏是大型分布式程序的先例,一个游戏,往往配置了成千上百的服务器去存储游戏玩家的各个信息,如账号信息,财产信息,邮件信息....当成千上万游戏客户端在不停的向各个服务器发送大量请求时,服务器如何精准的确定每一个客户端状态并进行同步就面临这一个很大的问题

   1. 为什么一些计算机不放在服务器上
      1. 软件架构已经设计好,如果修改的话,成本太高
   2. 为什么这些数据要给客户端
      1. 网络延迟问题
   3. 为什么这些计算不在检测
      1. 计算成本太高,没人去写这些

   

**需要的基本技能**

程序开发能力,逆向分析能力,协议分析测试能力

当然,有接入好的协议工具的前提下,有协议分析测试能力这一项就可以开工了

**常用的开发工具**

VC,Delohi,易语言

**常用的逆向调试分析工具**

WinDbg,IAD,OllyDbg

WinDbg 时window 平台下强大的Ring3 和Ring0 调试工具,在游戏漏洞挖掘中,主要用于调试分析反外挂驱动的保护点,以便写出反反外挂驱动

IDA 是一个世界顶级的Ring3 交互式反汇编工具,是最强大的静态分析工具(也可以动态调试),在分析整体程序流程,算法方面非常有优势,即使不能过掉反外挂系统,也可以用dump 下的游戏内存静态分析出游戏明文收发包等重要函数

OllyDbg 是window 平台下Ring3 级调试器,界面友好,非常容易上手,也支持插件扩展功能,是当今最流行最强大的动态调试工具,目前做辅助的基本均用此调试器分析需要的资源结构,内存数据,功能函数用于开发辅助功能

**常用内存搜索修改工具**

cheatengine(CE) , Memory Hacking Software(Mhs) , 金山游侠等

**常用的协议工具**

对于市面上的网游, WPE ,封装助手这类工具已基本无用武之地,相关人员会根据自身需求去开发协议工具

### 2.漏洞的分析

当前游戏漏洞方面还没有权威的定义和分类方法,不同的人可能会有不同的分类方式,比如有些人喜欢按游戏玩法模块来划分漏洞,把漏洞分为任务系统漏洞,战队系统漏洞,对战系统漏洞等等,游戏安全实现是定位还是希望走纯技术交流的专业路线,所以这里所说地分类方法主要是从技术角度来分析漏洞形成的原因,进行归纳总结出来的分类方法,仅供大家参考

**1.外挂功能漏洞**

外挂功能漏洞主要是指对游戏核心玩法的游戏平衡会带来影响的漏洞,游戏开发初期由于选择的网络架构(网络同步方式) 不合理,导致了部分关键逻辑被放在客户端处理,这种做法就会带来相应外挂风险,由于网络架构设计改动起来工作量大,一旦运营就很少在改动

....

### 3.动作类角色扮演类的游戏风险表

| 风险点        | 外挂行为                                | 外挂危害                                   |
| ------------- | --------------------------------------- | ------------------------------------------ |
| 血量          | 修改任务血量,怪物血量                   | 弱怪,秒怪,无敌                             |
| 伤害          | 修改人物受到的伤害,怪物受到的伤害       | 秒怪,无敌                                  |
| 技能 CD       | 技能少 CD                               | 快速发技能,无限技能                        |
| 直接胜利      | 主动发送请求胜利,不产生怪               | 快速瞬间移获取收益                         |
| 技能 ID       | 修改角色技能 ID                         | 使用未获得的技能,使用高级技能,使用他人技能 |
| buffid        | 修改自己或者敌方当前buffid 为其他buffid | 增强自己技能的buff,削弱敌方buff            |
| buff 持续时间 | 增加buff 时长,锁定buff 时长             | 我方buff 无限,减少敌方buff 时间            |
| 定怪          | 使怪物不动                              | 快速杀怪通关                               |
| 怪物不攻击    | 怪物不攻击玩家                          | 不掉血快速杀怪通关                         |
| 全屏          | 全屏攻击命中                            | 快速大范围杀怪                             |
| 穿透          | 使所有攻击从主角上穿透过去              | 主角无敌状态                               |
| 属性          | 修改英雄属性,装备属性                   | 相应属性有所加成,主角更易通关或获取分数    |
| 物品总数      | 修改物品数量,无限物品                   | 可无限使用物品效果或者技能效果             |

###  协议测试

**1.文件修改**

客户端基本上都有加密,压缩,校验,首先得解密文件且文件修改能实现的BT 功能一定可以通过内存修改和协议测试实现,所以对于游戏漏洞挖掘无太大价值

**2.内存修改**

包括普通内存数据修改和代码段修改:

1. 游戏可通过内存修改,快速检测是否可实现无敌,必杀,投篮必进之类的效果
2. 测试一些功能但因为本身条件未达成而客户端主动绕开了发包流程,可通过修改内存数据或者关键跳让客户端进入发包流程以便进行协议测试

**3.协议测试**

对于一个网络软件,协议测试必定是挖掘漏洞的最佳途径

一个游戏通讯协议种类繁多,在尽量对协议做全覆盖的前提下,以传统RPG 网游为例

应严格关注的地方:

1. 交易系统
2. 装备,宝石等道具升级系统
3. 任务系统
4. 物品存储,拆分,销毁系统
5. 遇怪,副本系统
6. 技能学习使用
7. 社会系统(家族,国家,世界)
8. 组队系统
9. 角色登入系统
10. 其他注意事项

**1.交易系统**

商城购买,拍卖,邮寄,玩家交易,NPC 买卖,摆摊,修理系统等

测试点:修改协议中对应物品的ID ,金钱信息,物品序号,角色编号,一物多用等

可能的影响:刷钱,复制道具,得到未开放的测试道具,异常道具,服务器异常,影响到拍卖异常显示

**2.装备,宝石等道具升级系统**

测试点:严格对协议中涉及的道具ID ,位置,个数,类型字段等进行替换测试工作