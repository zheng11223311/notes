### 1.对象串行化操作

**1.什么是串行化**

1. 将对象编成一个字符串的过程就是对象串行化

**2.作用:**

1. 方便长久的保存对象
2. 方便在网络上进行传输

**3.魔术方法**

1. __sleep()
   1. 触发时机:对象进行串行化操作时自动触发
   2. 功能:指定需要串行化的成员属性
   3. 参数:无
   4. 返回值:需要返回一个数组类型,每个元素都是需要串行化的成员属性名
2. __wakeup()
   1. 触发时机:对象反串行化操作时自动触发
   2. 功能:反串行化操作时修改部分成员属性
   3. 参数:无
   4. 返回值:无

**4串行化与反串行化相关的函数**

串行化操作:变量=seralize(对象变量);

反串行化操作:对象变量=unseralize(串行化后的变量);

**Canda 文件夹下**

Plane.class.php

```php
<?php
class Plane{
    // 成员属性
    public $head='机头';
    public $body='机身';
    public $chibang='可乐鸡翅';
    public $pigu='鸡屁股';
    public $engine='螺旋喷屁式引擎';
    public $age=0;
    // 成员方法
    function fly(){
        echo '大家坐稳了,我要起飞了';
    }
    function run(){
        echo '快跑啊,火烧屁股了';
    }
    //新增一个魔术方法 __sleep,对象调用serialize() 方法时触发,返回数组
    // ,数组内为seralize() 要显示的成员属性,如果没有__sleep(), seralize() 显示类所有成员属性
    function __sleep(){
        return  array('head','engine','age');
    }
    // 新增一个魔术方法 __wakeup() 对象调用unserialize() 方法时触发,返回数组
    function __wakeup(){
        //反串行化时更新部分成员属性
        $this->age +=0.5;
    }
}
?>

```

zbsh.php

```php
<?php
include './Plane.class.php';
// 制作飞机
$bsh=new Plane;
var_dump($bsh);

?>
```

**China(与Cananda 同级) 文件夹下**

zbsh.php

```php
<?php
include '../Cananda/Plane.class.php';
// 制作飞机
$bsh=new Plane;
var_dump($bsh);

$bsh->age=3;

// 破坏飞机
$bsh->head='火鸡头';
$bsh->engine='螺旋喷不出屁式引擎';

var_dump($bsh);

//将飞机拆成零件 运会cananda
// 将任意值转换成字符串
$re=serialize($bsh);
var_dump($re);
// string 'O:5:"Plane":6:{s:4:"head";s:9:"火鸡头";s:4:"body";s:6:"机身";s:7:"chibang";s:12:"可乐鸡翅";s:4:"pigu";s:9:"鸡屁股";s:6:"engine";s:27:"螺旋喷不出屁式引擎";s:3:"age";i:0;}' (length=190)
// O =>object 5 个长度(Plane)
// 6  =>6个成员属性
// 键=> s 4个长度字符串(head) =>值=> s 9 个长度(火鸡头)  ....  
// s:3:"age";i:0;   s=>string 长度为3(age)  i=>int  0

// 将零件打包运回cananda
file_put_contents('./bsh.txt',$re);
//将文件bsh.txt 复制到cananda 文件夹下
?>
```

bsh.txt

```txt
O:5:"Plane":3:{s:4:"head";s:9:"火鸡头";s:6:"engine";s:27:"螺旋喷不出屁式引擎";s:3:"age";i:3;}
```

### 2.对象反串行化操作

**Canda 文件夹下**

repair.php

```php
<?php
// 包含飞机类
include './Plane.class.php';

//拿到零件
$bshlj=file_get_contents('./bsh.txt');
//将零件再次组装成飞机对象 反串行操作
$re=unserialize($bshlj);  //返回成对象,包含被破环的零件属性
var_dump($re);
?>
```

