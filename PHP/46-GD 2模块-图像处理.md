### 1.GD2 模块-图像处理

**1.学习GD 2模块**

1.那些地方需要用到图像处理

1. 验证码
2. 相册中的图片 缩放 水印
3. 在线生成图片

**2.学习GD 2模块**

在phpinfo() 查看界面是否有显示gd 的文字,有就是开启了GD 2模块 

```php
<?php
echo phpinfo();
?>

```

![Snipaste_2021-10-21_19-06-13](D:\学习\wanye\PHP\img\Snipaste_2021-10-21_19-06-13.png)

如果没有开启,在php.ini 中搜索extension=gd2,将;extension=gd2 前面的; 去掉,也有可能叫extension=php_gd2.dull,重启服务器

开启后还是没有用,是因为没有这个模块

在wamp64/bin/php/php7.4.0/ext/php_gd2.dull  如果没有php_gd2.dull  需要自己去官网下载,

下载安装后重启服务器

### 2.绘图步骤

**1.现实中画布如何绘画(绘图步骤)**

1. 准备纸或者画布
2. 为每一幅画调配颜色
3. 拿绘画笔
4. 告诉别人你画的是什么
5. 把画卖掉或者自己留着
6. 收拾东西走人

**2.使用GD2 程序绘图步骤**

1. 创建画布
2. 为每一幅画布分配颜色
3. 使用相关函数进行绘图操作(点,圈,线)
4. 通知浏览器图片的相关信息(jpg,jpeg,png)
5. 将图片显示到浏览器或者保存到本地
6. 释放资源

**3.使用GD2 相关的函数进行绘图操作**

1. imagecreate() 创建基于调色板的图像(意思是颜色少,只能表示256 种颜色,适合做gif 图像)
2. inagecreatetruecolor() 创建一个真彩色的图像(意思是颜色多,能表示出65535种颜色值,适合做jpg\png)
   1. 两者的参数一样
   2. 参数1:图像的高度
   3. 参数2:图像的宽度
   4. 返回值:返回创建成功后的图像资源
3. imagecolorallocate() 为每一张画布分配颜色
   1. 参数1:成功创建画布返回的资源
   2. 参数2:红色
   3. 参数3:绿色
   4. 参数4:蓝色
4. imagefill() 区域填充
   1. 参数1:成功创建画布函数返回的资源
   2. 参数2:填充开始的X 点
   3. 参数3:填充开始的Y 点
   4. 参数4:要填充的颜色由imagecolorallocate 创建颜色返回的数字标识
5. header("Content-type:image/png"); 告诉浏览器图片的信息,使用对应的imagepng 函数
   1. imagepng()	输出或者保存png 图像
      1. 参数1:成功创建画布函数返回的资源
      2. 参数2:可选参数,如果设置表示需要保存图片,填写保存图片的路径
   2. imagejpeg()  输出或者保存jpeg 图像
   3. imagegif()     输出或者保存gif 图像
6. imagedestroy() 销毁一个图像
   1. 参数1:由创建图像函数成功返回资源
   2. 返回值:成功返回true,失败返回false

**示例**

```php
<?php

//1.创建基于调色板的画布
// $img=imagecreate(500,500);
// var_dump($img); //resource(2, gd)

//1.创建一个真彩色的画布
$img=imagecreatetruecolor(500,500);
// var_dump($img); //resource(2, gd),打印必须注释掉,否则图片无法显示
//2.为每一张图片分配颜色
$red=imagecolorallocate($img,255,255,255);
$hei=imagecolorallocate($img,0,0,0);
$lv=imagecolorallocate($img,0,255,0);
$huang=imagecolorallocate($img,255,255,0);
$purple=imagecolorallocate($img,106,0,106);
$blue=imagecolorallocate($img,0,0,255);
// var_dump($red);  //16711680
//3.使用相关函数进行绘色
    //1.将红色分配到这个画布的背景色
    $res=imagefill($img,0,0,$red);
    // var_dump($res); //resource(2, gd)
    //2.画一个矩形  左上角,右下角
    imagerectangle($img,100,100,400,400,$hei);
    //6.画矩形且填充
    imagefilledrectangle($img,50,50,200,200,$purple);
    //3.画线 左上角,右下角
    imageline($img,100,100,400,400,$lv );
    imageline($img,100,400,400,100,$lv );
    //4.画圆    中心点x,y   长宽
    imageellipse($img,250,250,100,100,$huang);
    //5.画圆且填充
    imagefilledellipse($img,250,250,50,50,$huang);
    //7.画点 单一一个像素  坐标
    imagesetpixel($img,10,10,$hei);
    //8.写字 水平写字 4 字体大小(最大字体就是5) 位置xy
    //不能写汉字,只能读取到汉字的一个字节
    imagechar($img,4,10,10,'aaaa',$blue);
    // 垂直写字
    imagecharup($img,4,10,10,'hhh',$blue);
    for($i=0;$i<1000;$i++){
        imagesetpixel($img,mt_rand(1,499),mt_rand(1,499),$hei);
    }
    // 9.使用字体库函数写入字体内容, 字体文件以.ttf 结尾
    //20 字体大小 0清洁度   60 x y  字体 'msyh.ttf', 7.0之后使用绝对路径
    // imagettftext($img,20,0,60,60,$lv,'./msyh.ttf','学习园地');
    //推荐使用imagefttext 写入字体函数
    // imagefttext($img,20,0,60,60,$lv,'./msyh.ttf','学习园地');

//4.通知浏览器图片相关信息
header("Content-type:image/png");//自己随便定义
// //5.将图片显示到浏览器还是保存到本地
imagepng($img);    //与 image/jpeg 对应,如果是jpg,使用imagejpg()



//6.释放资源
imagedestroy($img);
?>

```

