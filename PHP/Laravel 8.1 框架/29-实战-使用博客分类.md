# 使用博客分类



**创建分类数据辅助函数**

编辑`app/helpers.php`文件,写入:

```php
<?php
    
/**
 * 返回博客分类
 * 返回格式
 * [
 *  [id=>name],
 *  [id=>name],
 *  [id=>name],
 * ]
 */

use Illuminate\Support\Facades\DB;

// 如果不存在categories 函数
if (! function_exists('categories')) {
    
    function categories()
    {
        //查询数据库
        // 返回顺序作为下标
        // $categories=DB::table('categories')->get();

        // 查询列
        // pluck 参数  要查询列作为值[,要查询的列作为键]
        $categories=DB::table('categories')->pluck('name','id');

        return $categories;
    }
}
```

访问博客时出现报错`Target class [] does not exist.`

原因:之前定义中间件没有指定中间件`middleware('')`

`app\Http\Controllers\Blogcontroller.php`

```php
    public function __construct()
    {
        // middleware('') 使用空字符,会导致报错
        // Target class [] does not exist.
        // $this->middleware('');
        // 此控制器都使用auth 中间件,排除show 方法
        $this->middleware('auth')->except('show');
    }
```



**在博客添加页面使用分类:**

`resources\views\blog\create.blade.php`

```php
<div class="form-group">
                        <label for="exampleForControlSelect1">分类</label>
                        <select type="password" class="form-control" id="exampleForControlSelect1">
                            <option value="0">请选择分类</option>
                            @foreach (categories() as $id=>$name)
                                <option value="{{$id}}">{{$name}}</option>
                            @endforeach
                        </select>
                    </div>
```

`resources\views\blog\edit.blade.php`

```php
<div class="form-group">
    <label for="exampleFormControlSelect1"> 分类</label>
           <select class="form-control" id="exampleFormControlSelect1">
                    <option value="0">请选择分类</option>
                    @foreach (categories() as $id=>$name)
                          <option value="{{$id}}">{{$name}}</option>
                     @endforeach
            </select>
</div>
```

