# 路由

参考手册 [路由 | 基础功能 |《Laravel 8 中文文档 8.x》| Laravel China 社区 (learnku.com)](https://learnku.com/docs/laravel/8.x/routing/9365) 



**掌握内容**

- 基本路由
- 默认路由文件
- 可用路由方法
- 重定向路由
- 视图路由
- 路由参数
- 命名路由
- 生成指定路由的URL



**web 路由**

在`项目(blog)/routes/web.php `编写路由

```php
<?php

use Illuminate\Support\Facades\Route;


// 访问localhost:8000
// 访问127.0.0.1:8000
// 使用get 请求
Route::get('/', function () {
    return view('welcome');
});

// 访问localhost:8000/foo
Route::get('foo', function () {
    return 'Hello World';
});

// 有的时候你可能需要注册一个可响应多个 
//HTTP 请求的路由，这时你可以使用 match 方法，
//也可以使用 any 方法注册一个实现响应所有 HTTP 请求的路由：

// 只匹配get 和post 请求
Route::match(['get', 'post'], '/', function () {
    return '哈哈哈哈,相同路径的路由会被覆盖掉';
});

// 任意方式请求
// Route::any('/', function () {
//     //
// });


// 重定向路由
// 将/foo 重定向到/
// [第三个参数,自定义状态码],默认是302
Route::redirect('/foo', '/', 301);


//视图路由
// 访问位置,参数2:响应页面,参数三:传递值
// 页面在 项目/resources/views/welcome.blade.php
Route::view('/view', 'welcome');
Route::view('/welcome', 'welcome', ['name' => 'Taylor']);

// 必填参数
// id 必须填写
// 现在fun 中的 id 可用与{id} 名字不一样,以前必须一样,按顺序一一对应
Route::get('user/{id}', function ($id) {
    return 'User ' . $id;
});

// 可选参数
// 你可能需要指定一个路由参数，但你希望这个参数是可选的。
// 你可以在参数后面加上？标记来实现，
// 但前提是要确保路由的相应变量有默认值：
Route::get('user/{name?}', function ($name = 'aaa') {
    return $name;
});

// 正则表达式约束
Route::get('user1/{name}', function ($name) {
    return $name;
})->where('name', '[A-Za-z]+');


// 路由命名
// 路由命名可以方便地 为指定路由生成 URL  或者  重定向
//profile 指向 user2/profile
Route::get('user2/profile', function () {
    // 生成链接...
    $url = route('profile');
    dd($url);    //dd()封装后的打印函数 "http://127.0.0.1:8000/user2/profile"

    // 生成重定向...
    //return redirect()->route('profile');

})->name('profile');


// 如果有定义参数的命名路由，
// 可以把参数作为 route 函数的第二个参数传入，
// 指定的参数将会自动插入到 URL 中对应的位置：

// 访问http://127.0.0.1:8000/user3/555/profile
Route::get('user3/{id}/profile', function ($id) {
    // 多个参数,向数组中添加
    $url = route('profile', ['id' => 1]);
    // 只有一个参数,可以直接写
    $url = route('profile', 1);
    dd($url);   //"http://127.0.0.1:8000/user3/1/profile"
})->name('profile');

```

> 由于laravel 为保护数据的安全,`post `,`put`,`delete`,`patch` 等修改数据的请求,使用了`CSRF` 保护,没有令牌字段,默认是请求不到数据的

需要在`项目/app/Http/Kernel.php`下修改

```php
    protected $middlewareGroups = [
        'web' => [
            \App\Http\Middleware\EncryptCookies::class,
            \Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse::class,
            \Illuminate\Session\Middleware\StartSession::class,
            // \Illuminate\Session\Middleware\AuthenticateSession::class,
            \Illuminate\View\Middleware\ShareErrorsFromSession::class,
            // \App\Http\Middleware\VerifyCsrfToken::class,		//将这段注释即可
            \Illuminate\Routing\Middleware\SubstituteBindings::class,
        ],

        'api' => [
            'throttle:api',
            \Illuminate\Routing\Middleware\SubstituteBindings::class,
        ],
    ];
```

**页面视图**

路由中使用到的页面在 `项目/resources/views/xxx.blade.php`

