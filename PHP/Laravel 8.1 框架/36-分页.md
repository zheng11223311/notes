# 分页

参考手册  [分页 | 数据库 |《Laravel 8 中文文档 8.x》| Laravel China 社区 (learnku.com)](https://learnku.com/docs/laravel/8.x/pagination/9402) 



**掌握内容**

- 基本用法
- 显示分页结果
- 自定义分页视图



## 简介

在其他框架中，分页可能是非常痛苦。`Laravel` 的分页器将 查询构造器 和 `Eloquent ORM` 结合起来，提供了方便、易用的数据库结果集分页。通过分页器生成的 `HTML `兼容 `Bootstrap CSS` 框架。





**自定义分页视图**

 默认情况下，渲染视图来显示分页链接是与 `Tailwind CSS `框架兼容的。然而，如果你不想使用 `Tailwind`，你可以自由的选择你自己定制的视图来渲染这些链接 

 最简单的方法是使用 `vendor:publish` 命令将它们输出到 `resources/views/vendor` 目录： 

```powershell
php artisan vendor:publish --tag=laravel-pagination
```

这个命令将在` resources/views/vendor/pagination `目录中放置这些视图。内置在该目录下的 `tailwind.blade.php` 文件提供了默认的分页视图。你可以编辑这个文件来修改分页的 `HTML`。

```php
{{ $paginator->links('view.name') }}

// 将数据传递给视图...
{{ $paginator->links('view.name', ['foo' => 'bar']) }}
```

如果你想要定义不同的文件作为默认的分页视图，你需要在 `AppServiceProvider` 中使用分页器的 `defaultView `和 `defaultSimpleView `方法：

```php
use Illuminate\Pagination\Paginator;

public function boot()
{
    Paginator::defaultView('view-name');

    Paginator::defaultSimpleView('view-name');
}
```





`app\Http\Controllers\IndexController.php`

```php
<?php

namespace App\Http\Controllers;

use App\Models\Blog;
use Illuminate\Http\Request;

class IndexController extends Controller
{
    /** 使用/** 热键 就会自动生成注释
     * 博客首页
     */
    public function Index(){
        // dd('博客首页');

        // 查询博客数据
        // 查询已发布的数据
        // $blogs=Blog::where('status',1)->get();
        // dd($blogs);
        // 分页获取,paginate 默认15条
        // paginate 分页功能较多,simplePaginate 简单分页只有上一页和下一页
        // $blogs=Blog::where('status',1)->paginate();
        // 每页2条
        // 访问 http://localhost:8000/?page=1
        // 访问 http://localhost:8000/?page=2
        $blogs=Blog::where('status',1)->paginate(2);
        // 将数据转换为json
        // $blogs=Blog::where('status',1)->paginate(2)->toJson();
        // dd($blogs);
        return view('index.index',['blogs'=>$blogs]);
    }
}

```

`resources\views\index\index.blade.php`

```php
                    <div class="card-body">
                        @foreach ($blogs as $blog)
                            <div class="article-body">
                                <div>
                                    {{-- 等以后讲到模型关联,将id 替换为对应的名称 --}}
                                    <span class="article-author">{{$blog->user_id}}</span>
                                    {{-- $blog->updated_at 是一个 carbon 对象,dd打印看出, 在packagist 中搜索carbon,就可以看到使用方法 --}}
                                    {{-- diffForHumans carbon 的时间格式化 --}}
                                    {{-- {{dd($blog->updated_at);}} --}}
                                    <span class="article-time">{{$blog->updated_at->diffForHumans()}}</span>
                                </div>
                                <h2 class="font-weight-bold my-3 article-title">
                                    {{-- <a class="text-dark" href="{{route('blog.show',['blog'=>1])}}">博客博客博客博客博客博客</a> --}}
                                    <a class="text-dark" href="{{route('blog.show',1)}}">{{$blog->title}}</a>
                                </h2>
                                <div class="article-des">{{$blog->content}}</div>
                                <div>
                                    {{-- 标签 --}}
                                    {{-- categories() 自定义辅助函数 app/helpers.php --}}
                                    <a href="#" class="badge badge-warning mt-3 article">{{categories()[$blog->category_id]}}</a>
                                </div>
                            </div>
                            <hr>
                        @endforeach
                        {{-- 系统默认的css 不是bootstrap ,这里显示的就会乱 --}}
                        {{-- 需要在 app/Providers/AppServiceProvider.php 中修改 --}}
                        {{-- {{$blogs->links()}} --}}
                        {{-- 附加参数到分页中 --}}
                        {{-- {{$blogs->appends(['sort'=>'votes'])->links()}} --}}
                        {{-- 附加全部查询参数 --}}
                        {{-- {{$blogs->withQueryString()->links()}} --}}
                        {{-- 两边显示多少个分页 --}}
                        {{$blogs->onEachSide(1)->links() }}
                        {{-- <nav class="d-flex justify-content-center mt-4">
                            <ul class="pagination">
                                <li class="page-item disabled">
                                    <a href="#" class="page-link" tabindex="-1" aria-disabled="">上一页</a>
                                </li>
                                <li class="page-item">
                                    <a href="#" class="page-link">1</a>
                                </li>
                                <li class="page-item active" aria-current="page">
                                    <a href="#" class="page-link">
                                        2 
                                       
                                    </a>
                                </li>
                                <li class="page-item">
                                    <a href="#" class="page-link">3</a>
                                </li>
                                <li class="page-item">
                                    <a href="#" class="page-link">下一页</a>
                                </li>
                            </ul>
                        </nav> --}}
                    </div>
                </div>
            </div>
            <div class="col-sm-3 p-0">
                @include('common.right-card',[
                    'imgUrl'=>'https://www4.bing.com//th?id=OHR.SwedishAntenna_ZH-CN9163420082_1920x1080.jpg&rf=LaDigue_1920x1080.jpg&pid=hp&w=240&h=135',
                    'title'=>'博客网站',
                    'content'=>'一个用来学习Laravel 的博客项目,基于Bootstrap4.0 开发',
                    // 'count'=>$blogs->count()     //当前页的数量
                    'count'=>$blogs->total()     //总数量
                ])
            </div>
```

`app\Providers\AppServiceProvider.php`

```php
<?php

namespace App\Providers;

use Illuminate\Pagination\Paginator;
use Illuminate\Support\ServiceProvider;

class AppServiceProvider extends ServiceProvider
{
    /**
     * Register any application services.
     *
     * @return void
     */
    public function register()
    {
        //
    }

    /**
     * Bootstrap any application services.
     *
     * @return void
     */
    public function boot()
    {
        //将分页视图默认样式修改为bootstrap
        Paginator::useBootstrap();
    }
}

```

