### 1.多文件上传

```php
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文件上传</title>
</head>
<body>
    <!-- method="post" enctype="multipart/form-data" 必须写 -->
    <form action="./1-php copy 22.php" method="post" enctype="multipart/form-data">
    <!-- multiple 设置多个文件上传 -->
    <!-- 将 pic 改为 pic[] php $_files 可以接收多个文件 -->
        <input type="file" name="pic[]" multiple id="">
        <input type="submit" value="上传">
    </form>
</body>
</html>
```

**1-php copy 22.php 文件**

```php
<?php
// var_dump($_FILES);
//得到多文件上传地数组通过遍历方式将多维数组
// 遍历成单文件形式地使用单文件上传函数，然后循环调用
function uploads($pic,$path='./upload',$size=100000,array $type=array('image/jpeg','image/png','image/gif')){
    // 1.实现单文件上传（对一个上传文件信息地一维数组进行判断）
    function inner($file,$path,$size,$type){
        //定义返回信息
        $info=[];
        //1.判断错误号
        if($file['error']>0){
                switch($file['error']){
                    case 1:
                        return "超过PHP 设置的最大值";
                    case 2:
                        return '文件超过表单的最大值';
                    case 3:
                        return "只有部分文件上传";
                    case 4:
                        return "没有文件上传" ;
                    case 6:
                        return '找不到临时文件' ;
                    case 7:
                        return "文件写入失败" ;
                }
            }
          // 2.判断文件大小是否合法
          if($file['size']>$size){
            return '亲.您传的是大象吗?';
          }
          // 3.判断上传文件地类型是否合法
        if(!in_array($file['type'],$type)){
            return '上传的文件不合法';
        }
        //制作保存地路径
        $path=rtrim($path,'/\\').'/';

        //4.判单上传保存的目录是否存在 不存在则创建
        if(!file_exists($path)){
            mkdir($path,0777,true);
        }
        //5.为上传的文件重命名
        $uffix=strrchr($file['name'],'.');
        do{
            $name=md5(time().mt_rand(1,1000).uniqid()).$file['name'];
        }while(file_exists($path.$name));    //唯一

        // 6.移动保存文件
      if(move_uploaded_file($file['tmp_name'],$path.$name)){
        $info['name']=$name;
        $info['path']=$path;
        $info['pathName']=$path.$name;
        return $info;

        }else{
            echo '上传失败!';
        }
       
        
    }   
    //遍历多文件    
    $file=array();
    $infos=[];
    foreach ($_FILES[$pic]['name'] as $key => $value) {
        // $value 为单个文件地信息
        $file['name']=$value;
        $file['type']=$_FILES[$pic]['type'][$key];
        $file['tmp_name']=$_FILES[$pic]['tmp_name'][$key];
        $file['error']=$_FILES[$pic]['error'][$key];
        $file['size']=$_FILES[$pic]['size'][$key];
        //调用文件上传函数
        $infos[]=inner($file,$path,$size,$type);
    }
    return $infos;
}
var_dump(uploads('pic','./upload'));	
?>

```

