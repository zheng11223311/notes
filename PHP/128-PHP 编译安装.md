### 1.PHP 编译安装

编译之前请确保系统已经安装了libtool 和libtool-ltdl 软件包,安装

```
yum -y install "libtool*"

cd /lamp/php-7.0.7
./configure --prefix=/usr/local/php/ --with-config-file-path=/usr/local/php/etc/ 
--with-apxs2=/usr/local/apache2/bin/apxs  --with-libxml-dir=/usr/local/libxml2/
--with-jpeg-dir=/usr/local/jpeg6/  --with-png-dir=/usr/local/libpng/
--with-freetype-dir=/usr/local/freetype/   --with-mcrypt=/usr/local/libmcrypt/
--with-mysqli=/usr/local/mysql/bin/mysql_config --enable-soap --enable-mbstring=all
--enable-sockets --with-pdo-mysql=/usr/local/mysql --with-gd --without-pear

若前面配置zlib 时没有指定安装目录,PHP 配置时不要添加 -with-zlib-dir=/usr/local/zlib/ 参数

选项:
--with-config-file-path=/usr/local/php/etc/     //指定配置文件目录
--with-apxs2=/usr/local/apache2/bin/apxs		//指定apache 动态模块位置
--with-libxml-dir=/usr/local/libxml2/			//指定libxml 位置
--with-jpeg-dir=/usr/local/jpeg6/				//指定jpeg 位置
--with-png-dir=/usr/local/libpng/				//指定png 位置
--with-freetype-dir=/usr/local/freetype/		//指定freetype 位置
--with-mcrypt=/usr/local/libmcrypt/				//指定libmcrypt 位置
--with-mysqli=/usr/local/mysql/bin/mysql_config	//指定mysqli 位置
--with-pdo-mysql=/usr/local/mysql				//启用mysql 的pdo 模块支持
--without-pear									不安装pear (安装pear 需要连接互联网,pear 是php 的 扩展与应用库)
--with-gd										//启用gd 库
--enable-soap									//支持soap 服务
--enable-mbstring=all							//支持多字节,字符串
--enable-sockets 								//支持套接字


make 
make install

//生成php.ini
mkdir /usr/local/php/etc/
cp /lamp/php-7.0.7/php.ini-production   /usr/local/php/etc/php.ini

//测试Apache 与PHP 的连通性,看Apache 是否能解析php 文件
vim /usr/local/apache2/etc/httpd.conf
搜索AddType ,在其之后添加以下内容
AddType application/x-httpd-php.php.phtml
AddType application/x-httpd-php-source.phps
(注意大小写)
// .phtml 为将.phps 作为PHP 源文件进行语法高亮显示,如果没有这两句,则浏览php时,会直接下载,或者显示源码

//重启Apache 服务:
/usr/local/apache2/bin/apachectl stop
/usr/local/apache2/bin/apachectl start

//Apache 无法启动,提示cannot restore segment prot after reloc:Permission denied 错误
为SELinux 问题,可关闭SELinux 或者执行命令chcon -t textrel_shlib_t /usr/local/apache2/modules/libphp5.so

//测试:
vim /usr/local/apache2/htdocs/test.php
<?php phpinfo();?>
//通过浏览器输入地址访问:http://Apache 服务器地址/test.php
Rpm 包安装的网页默认目录  /var/www/html/
//有时第一次浏览器测试会失败,关闭浏览器重启在尝试即可,非编译错误
```

