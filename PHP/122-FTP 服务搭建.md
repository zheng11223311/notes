### 1.FTP 服务搭建

FTP 文件上传下载服务

**1.软件准备**

vsftpd   //安全,稳定   存在IOS 镜像文件中(自带)

**2.FTP 端口**

FTP 端口     21   提供命令传输功能

​					20   传输数据文件

**3.用户**

- 系统用户 (Linux 里面添加的用户,可以执行使用,登入FTP,默认可以上传文件)
- 匿名用户(任意用户,可以访问,默认不允许上传文件)

### 2.搭建FTP 服务器

- 安装软件

  - ```
    mount /dev/sr0   /media
    cd /media/Packages/      //软件存放的目录
    ls vsftpd-2.2.2-21.el6.rpm   //查看软件包
    yum -y install  vsftpd     //安装软件
    ```

- 配置文件

  - ```
    vim /etc/vsftpd.conf    //打开配置文件
    显示
    anonymous_enable=YES     //匿名用户是否可以登入
    local_enable=YES		//系统用户是否允许登入
    write_enable=YES        //系统用户是否可以上传
    connect_fro_port_20=YES  	//是否开启连接 20端口
    ftpd_banner=Wecome to blah FTP service   //登入服务器时显示的内容Wecome to blah(为用户名) FTP service ,默认是关闭的,这里打开
    listen=YES           //是否监听端口
    chroot_local_user=YES    //管理登入用户权限,默认是关闭的
    ```

- 启动服务 测试

  - 关闭防火墙 ,使用setup 命令

  - 关闭SELINUX(安全防护软件)

    - ```
      vim /etc/selinux/config
      SELINUX=enforcing     //强制运行安全软件,这里设置为disabled,关闭
      reboot 重启系统,软件对系统要求比较高,修改后需要重启系统
      ```

- 启动服务

  - ```
    service vsftpd start     //启动服务
    netstat -tlun    //查看网关信息
    netstat -tlun |grep :21   //查看21 端口的网关信息,没有时为空
    ```

  - 用户在window 系统上,在文件夹显示路径的地方输入ftp://192.168.254.100 即可匿名查看
  
  - 匿名用户登入的位置在Linux 的  /vcar/ftp/pub/
  
  - 匿名用户下载位置在Linux 的 /var/ftp/pub   只能下载文件,不能上传文件
  
  - 系统用户
  
    - 用户在window 系统上,在文件夹显示路径的地方输入ftp:/root@192.168.254.100
    - 输入密码登入
    - 系统用户登入位置在Linux 的/home/用户名    可以上传下载

**2.第三方工具登入 Filezilla**

可以不写用户名和密码,即视为匿名用户登入,端口都是21

**实验:限制登入用户的家目录范围(权限)**

用户ftp 登入时,不可以查看除/home 外其他目录文件

1. 修改配置文件

   1. ```
      vim /etc/vsftpd/vsftpd.conf
      chroot_local_user=YES   //将文件中的注释去掉,即可限制用户访问除家目录以外的目录
      
      service vsftpd restart  重启服务
      ```

   

   **不允许root 登入**

   ```
   vim /etc/vsftpd/ftpusers   //可以查看到不允许的用户登入,其中有root 用户(为了安全,不泄露密码,root 用户只可以xshell 连接),后面的都得伪用户,系统运行需要的
   ```

   

   