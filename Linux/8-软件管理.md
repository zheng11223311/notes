# 软件安装

## 一.概述

### 1.RPM 包

RPM : Package Manager(原 Red Hat package Manager,现在是一个递归缩写)

由Red Hat 公司提出,倍众多Linux 发行版所采用

也称二进制(binary code ) 无需编译,可以直接使用

无法设定个人设置,开关功能

软件包示例(注意后缀):mysql-community-commin-5.7.12-1.el7.x86_64.rpm

#### 1.认识RPM 包

zip-3.0-11.el7.x86_64.rpm

wget-1.14-15.el7.x86_64.rpm

tcpdump-4.9.0-5.el7.x86_64.rpm

**注释:**

zip-3.0-11.el7.x86_64.rpm

**软件包名:**zip

**版本号(Version): **3.0-11

**发布版本(Release5/6/7): ** el7	(enterprise Linux7  企业版第七代linux 系统)

**系统平台: **.x86_64(64位操作系统)

**文件后缀:**rmp

### 2.源码包

source code 需要经过GCC,C++ 编译环境才能运行

可以设定个人设置,开关功能

缺点是配置复杂

软件包示例: nginx-1.8.1.tar.gz

#### 1.认识源码包

**包名: **nginx

**版本号: **1.8.1

**压缩格式: **.tar.gz

## 二.RPM 包管理

### 1.YUM 工具

#### 1.简介

Yum (全程为 Yellow dog Updater,Modified)

是一个在Fedora 和RadHat 以及CentOS 中的shell 前端软件包管理器

基于RPM 包管理,能够从指定的服务器自动下载RPM 包并且安装

可以自动处理依赖性关系,并且一次安装所有依赖的软件包,无需繁琐的一次次下载,安装

#### 2.本地源:系统安装光盘

**目的:**

通知Linux 服务器,通过本机的系统光盘获得软件包(软件包存在于光盘中),并安装软件

**1.观察YUM 核心配置目录**

记住这个目录 /etc/yum.repos.d/	(yum 下载所存储的地址,repos 报道)

打开一个 *.repo	(下载地址(国外官方地址) mirrorlist:...)

观察国外地址(下载速度慢)

**2.删除官方YUM 库**

```shell
rm -rf /etc/yum.repos.d/*
#或者
mv /etc/yum.repos.d/*   /tmp		#相当于备份,可以还原
#或则
tar -cfv repos.tar  *		#打包压缩
```

**3.编写本地YUM 库配置文件**

```shell
vim /etc/yum.repos.d/dvd.repo		#/etc/yum.repos.d/dvd.repo	是YUM 下载地址库目录
#输入
[dvd]		
name=dvd
baseurl=file:///mnt/cdrom
gbgcheck=0

#[dvd]			某一个库的名称,中括号[] 是必须的
#name=dvd		是库的说明,name 是必须的
#baseurl=file:///mnt/cdrom 下载库的具体地址,重要  file://   /mnt/cdrom
#gbgcheck=0		0是关闭校验,由于开源包,可能会遭到篡改,需要下载校验码进行校验包的完整性
#enabled=1		#是否启用这个库, 1 是,0 否,没有这句话默认开启

yum makecache     #更新yum 仓库,修改dvd 配置后,清空原先缓存
```



**4.挂载安装光盘**

老铁千万记住要把光盘放到服务器上,通电,步骤如下

虚拟机设置->CD/DVD -> 使用ios 镜像文件 ->设备状态勾选已连接

否者mount 挂载失败

```shell
mkdir /mnt/cdrom		#准备一个文件夹

ls /dev/cdrom    #查看光盘位置

vim /root/.bashrc		#开机自动执行.bashrc 文件,挂载光驱
#写入
mount /dev/cdrom  /mnt/cdrom	#光盘买来时就是已经格式化过了的,直接挂载到/mnt/cdrom
#挂载前需要确保/dev/cdrom 这个盘存在,被挂载后需要卸载才能可以挂载,否则显示不能写入,只读


#查看光驱自带的软件包
ls /mnt/cdrom/Pacages/	|wc -l    #wc 查看数量, -l line 多少行,即多少个数量的软件包,需要使用的  90% 的软件包都在这里
```

**5.使用YUM 安装和卸载程序**

```shell
yum install -y httpd		#安装软件		-y 自动确定各种回复
systemctl start httpd 		#启动软件
systemctl stop httpd 		#关闭软件
ststemctl stop firewalld   #关闭防火墙
systemctl disable firewalld		#禁用防火墙,开机不自启
```

**6.模拟客户机访问**

打开虚拟机的浏览器,输入网站服务器的IP 地址,http://127.0.0.1 ,验证网站程序部署成功

#### 3.使用YUM 管理RPM 包

##### 1.安装

全新安装

```shell
yum -y install httpd vsftpd		#yum 主命令 -y 自动确认 install 安装  httpd 软件包1 vsftpd 软件包2
```

重新安装

当软件缺失文件,可尝试重新安装

```shell
yum -y reinstall httpd		#reinstall 重新安装
```

升级安装

```shell
yum -y update httpd		#升级一个httpd
yum -y update 			#升级操作系统
```

yum 使用帮助

```shell
yum --help
```

##### 2.查询

**查询HTTP 程序**

```shell
yum list httpd		#带@ 是已经安装的

#显示 
#包名    包版本    来源哪个库

yum list 			#查询本机仓库所有软件包

```

##### 3.卸载

```shell
yum -y remove httpd		#卸载httpd
```

#### 4.wget 网络下载

扩展内容,软件包管理

```shell
#阿里云 镜像地址
# https://developer.aliyun.com/mirror/?pageNum=&serviceType=mirror

#清除原有的YUM 配置
mv /etc/yum.repos.d/* /tmp/

#下载阿里云官网配置
wget -O /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-7.repo	# -O 指定下载到的位置(不存在则创建文件)   https... 下载仓库的地址

#epel  额外企业扩展包   centos+epel 满足大部分软件需求
wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo

#更新YUM 仓库
yum makecache

#查看源
yum repolist
#标签 名称 有多少包

#执行安装需要的软件
yum install
```



### 2.PRM 工具(系统自带工具)

#### 1.前言

管理红帽系统/centos 系统的 RPM 包的基本工具

与 YUM 功能相同

RPM 无法处理依赖

#### 2.安装(i)

先找到安装包

```shell
cd /mnt/cdrom/Packages		#查看是否存在wget 包

ls wget-1.14-15.el7x86_64.rpm

rpm -ivh wget-1.14-15.el7x86_64.rpm   #下载包	w word  i install  v 显示 h 百分比
#yum 安装wget
yum install -y wget-1.14-15.el7x86_64   #没有rpm 后缀
```

#### 3.查询(q)

```shell
rpm -q wget 		#看到软件包的名字,就说明rpm -q 查询成功,已经安装软件
```

#### 4.卸载(e)

```shell
rpm -evh wget-11.14-15.el7.x86_64

#再次查询,未安装软件包
rpm -q wget-11.14-15.el7.x86_64			#安装需要后缀名rpm,查询和卸载不需要后缀名
#安装是用软件包,查询和卸载是卸载软件
```

## 三.源码包管理

## 1.获得源码包

**官方网站可以获得最新的软件包**

Apache: www.apache.org

Nginx: www.nginx.org

Tengine:tengine.taobao.org	Nginx 的变种(马云用来应对双十一的)

## 2.实战案例

### **1.下载Tengine**

**1.直接官网下载**

tengine.taobao.org  选择download 下载最新版本

**2.wget 下载**

选中tengine 的下载地址,复制,

```shell
#wget 地址		需要先安装wget,相当于一个迅雷软件
wget http://tengine.taobao.org/download/tengine-2.3.3.tar.gz
```

**3.vmtools 虚拟机工具**

虚拟机中->虚拟机->重新安装vmtools

在真机下载好,利用vmtools 拖到虚拟机中

如果使用vmtools  工具拖拽文件进来后出现损坏,先卸载umount 光驱,一因为光驱占据了vmtooks 的文件夹/mnt/cdrom

```shell
umount /dev/cdrom   #卸载光驱
```



### 2.部署Tengine

**准备编译环境如编译器**

```shell
#如果将光驱卸载了,需要将光驱重新挂载上去

yum -y install gcc make zlib-devel pcre pcre-devel openssl-devel	# 安装 gcc 和 make 和 zlib-devel 和 pcre 和 pcre-devel 和 openssl-devel
#如果安装了,则会显示已安装
```

**解压**

```shell
#如果需要: 指定一个用户登入使用
useradd www			#创建www 用户

tar xvf tengine-2.3.3.tar.gz

cd tengine-2.3.3
```

**配置**

```shell
./configure  --user=www  --group=www  --prefix=/usr/local/nginx		#注意空格
# 指定用户user	指定组group	指定安装路径prefix  可以添加更多配置
```

**编译**

```shell
make 
```

**安装**

```shell
make install

#编译和安装可以同时写
make & make install
```

**启动测试**

可能之前的实验,安装过httpd 服务,如果直接启动nginx 会有端口冲突,请确保关闭httpd

```shell
systemctl  stop httpd #关闭httpd 服务
```

**启动**

```shell
/user/local/nginx/sbin/nginx

systemctl stop firewalld 
```

使用浏览器访问本机的IP(或127.0.0.1),如果能看见Nginx 的网页,说明部署成功

