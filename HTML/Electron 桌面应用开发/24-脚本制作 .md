# Nodejs使用robotjs轻松控制鼠标键盘

[![img](https://camo.githubusercontent.com/ae4ccf4d1609eaa89f3a02f3c60d169cbe53be5b941256ea579f31541458a981/68747470733a2f2f636c6475702e636f6d2f3141544466324a4d74762e706e67)](https://camo.githubusercontent.com/ae4ccf4d1609eaa89f3a02f3c60d169cbe53be5b941256ea579f31541458a981/68747470733a2f2f636c6475702e636f6d2f3141544466324a4d74762e706e67)

[![img](https://camo.githubusercontent.com/5a395a00ae8a1681b238c04962f3a13bc93422c979d11b26b317b122ff870d8f/68747470733a2f2f6170692e7472617669732d63692e6f72672f6f6374616c6d6167652f726f626f746a732e7376673f6272616e63683d6d6173746572)](https://travis-ci.org/octalmage/robotjs) [![img](https://camo.githubusercontent.com/800e27268e8943f08464c17e9a6c4a25c2a6df878cabdbc42df45d02f09e87c7/68747470733a2f2f63692e6170707665796f722e636f6d2f6170692f70726f6a656374732f7374617475732f71683265716233376a376170367833363f7376673d74727565)](https://ci.appveyor.com/project/octalmage/robotjs) [![img](https://camo.githubusercontent.com/72c83c70239e413724c13dea945bfd3b99f1523b0570fdd72be3d19dd0403f87/68747470733a2f2f696d672e736869656c64732e696f2f6e706d2f762f726f626f746a732e737667)](https://www.npmjs.com/package/robotjs) [![img](https://camo.githubusercontent.com/ceebd75288a5fe7ac5b3634e25a16ab570f0ec965a913f4b2fb6b8f5304df4f5/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6769747465722d6a6f696e253230636861742d626c75652e737667)](https://gitter.im/octalmage/robotjs?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge&utm_content=badge) [![img](https://camo.githubusercontent.com/9e6617cfb1e360285d1c15e23829dde8816f33dae7bd983bc3bdbf6900306100/68747470733a2f2f696d672e736869656c64732e696f2f776166666c652f6c6162656c2f6f6374616c6d6167652f726f626f746a732f72656164792e7376673f6d61784167653d33363030)](http://waffle.io/octalmage/robotjs)

> 节点.js桌面自动化。控制鼠标、键盘并阅读屏幕。

RobotJS支持Mac，[Windows](https://github.com/octalmage/robotjs/issues/2)和[Linux](https://github.com/octalmage/robotjs/issues/17)。

这是一项正在进行的工作，因此导出的函数可以在第一个稳定版本（1.0.0）之前随时更改。[想法？](https://github.com/octalmage/robotjs/issues/4)

[看看人们用RobotJS制作的一些很酷的东西](https://github.com/octalmage/robotjs/wiki/Projects-using-RobotJS)！您有自己的 rad RobotJS 项目吗？随意添加它！

[![img](https://camo.githubusercontent.com/bb51fcfe6c7b92ba1517e2344dc83a8565a5476f072190451ef8c843ef46502e/68747470733a2f2f636c6475702e636f6d2f45742d43365f756534352e706e67)](https://twitter.com/robotjavascript)[![img](https://camo.githubusercontent.com/c2c85983cbbd75cd23d3d72d9a0899f957aea908a3a604f5ddd5ff6be9666ef9/68747470733a2f2f636c6475702e636f6d2f3361704469724e6d53422e706e67)](http://blog.robotjs.io/)

## 内容

- [安装](https://github.com/octalmage/robotjs#installation)
- [例子](https://github.com/octalmage/robotjs#examples)
- [应用程序接口](https://robotjs.io/docs/syntax)
- [建筑](https://github.com/octalmage/robotjs#building)
- [计划](https://github.com/octalmage/robotjs#plans)
- [进展](https://github.com/octalmage/robotjs#progress)
- [常见问题](https://github.com/octalmage/robotjs#faq)
- [许可证](https://github.com/octalmage/robotjs#license)

## 安装

使用 npm 安装 RobotJS：

```
npm install robotjs
```

就是这么简单！npm 将为您的操作系统下载一个预构建的[二进制文件](https://github.com/octalmage/robotjs/releases/latest)。

如果您没有安装npm，则可以[在此处](https://nodejs.org/en/download/)获取npm。

如果您需要构建RobotJS，请参阅[构建](https://github.com/octalmage/robotjs#building)部分。[电子](https://github.com/octalmage/robotjs/wiki/Electron)说明。

## 例子

##### [鼠](https://github.com/octalmage/robotjs/wiki/Syntax#mouse)

[![img](https://camo.githubusercontent.com/56d14ab0838dec87809b993f8da3d8c7f51b8c9307d801c0cb16127d2278a133/68747470733a2f2f636c6475702e636f6d2f6c7567566a6a416b45692e676966)](https://camo.githubusercontent.com/56d14ab0838dec87809b993f8da3d8c7f51b8c9307d801c0cb16127d2278a133/68747470733a2f2f636c6475702e636f6d2f6c7567566a6a416b45692e676966)

```
// Move the mouse across the screen as a sine wave.
var robot = require("robotjs");

// Speed up the mouse.
robot.setMouseDelay(2);

var twoPI = Math.PI * 2.0;
var screenSize = robot.getScreenSize();
var height = (screenSize.height / 2) - 10;
var width = screenSize.width;

for (var x = 0; x < width; x++)
{
	y = height * Math.sin((twoPI * x) / width) + height;
	robot.moveMouse(x, y);
}
```

##### [键盘](https://github.com/octalmage/robotjs/wiki/Syntax#keyboard)

```
// Type "Hello World" then press enter.
var robot = require("robotjs");

// Type "Hello World".
robot.typeString("Hello World");

// Press enter.
robot.keyTap("enter");
```

##### [屏幕](https://github.com/octalmage/robotjs/wiki/Syntax#screen)

```
// Get pixel color under the mouse.
var robot = require("robotjs");

// Get mouse position.
var mouse = robot.getMousePos();

// Get pixel color in hex format.
var hex = robot.getPixelColor(mouse.x, mouse.y);
console.log("#" + hex + " at x:" + mouse.x + " y:" + mouse.y);
```

阅读[维基](https://github.com/octalmage/robotjs/wiki)以获取更多信息！

## [应用程序接口](http://robotjs.io/docs/syntax)

RobotJS API托管在 https://robotjs.io/docs/syntax。

## 建筑

在安装之前，请确保您具有所需的依赖项：

- 窗户
  - windows-build-tools npm 包（来自提升的 PowerShell 或 CMD.exe）`npm install --global --production windows-build-tools`
- 苹果电脑
  - Xcode 命令行工具。
- Linux
  - Python（建议使用 v2.7，不支持 v3.x.x）。
  - 做。
  - 像GCC这样的C / C++编译器。
  - libxtst-dev 和 libpng++-dev （）.`sudo apt-get install libxtst-dev libpng++-dev`

使用 npm 安装 node-gyp：

```
npm install -g node-gyp
```

然后构建：

```
node-gyp rebuild
```

有关更多详细信息，请参阅 [node-gyp 自述](https://github.com/nodejs/node-gyp#installation)文件。

## 计划

- √通过更改鼠标位置、左/右单击和拖动来控制鼠标。
- √ 按住键并键入单词来控制键盘。
- √ 从屏幕读取像素颜色并捕获屏幕。
- 在屏幕上查找图像，从图像中读取像素。
- 可能包括窗口管理？

## 进展

| 模块 | 地位 | 笔记                   |
| ---- | ---- | ---------------------- |
| 鼠   | 100% | 已实现所有计划的功能。 |
| 键盘 | 100% | 已实现所有计划的功能。 |
| 屏幕 | 85%  | 图像搜索，像素搜索。   |
| 位图 | 0%   | 保存/打开，png 支持。  |

## 常见问题

#### RobotJS是否支持全局热键？

目前没有，我不知道它是否会。我个人使用[Electron](http://electron.atom.io/)/[NW.js](http://nwjs.io/)作为全局热键，这很有效。稍后，我可能会添加热键支持或创建一个单独的模块。有关详细信息[，请参阅 #55](https://github.com/octalmage/robotjs/issues/55)。

#### 我可以用RobotJS截取屏幕截图吗？

很快！这比其他功能稍微复杂一些，所以我把它留到了最后。幸运的是，代码已经存在，我只需要编写绑定，并且我已经开始了。订阅[#13](https://github.com/octalmage/robotjs/issues/13)以获取更新。

#### 为什么键盘功能<插入键>缺失？

我们一直在实现我们需要的密钥。随意创建问题或提交拉取请求！

#### 多显示器支持如何？

该库没有明确的多显示器支持，因此任何工作都是偶然的。订阅 [#88](https://github.com/octalmage/robotjs/issues/88) 获取更新。

对于任何其他问题，请[提交问题](https://github.com/octalmage/robotjs/issues/new)。

## 故事

我是[AutoHotkey](https://www.autohotkey.com/)的忠实粉丝，我已经使用它很长一段时间了。AutoHotkey非常适合自动化，它可以做一堆在其他语言中非常困难的事情。例如，它[的图像搜索](https://www.autohotkey.com/docs/commands/ImageSearch.htm)和[像素](https://www.autohotkey.com/docs/commands/PixelGetColor.htm)相关功能很难在Mac上重现，特别是在脚本语言中。这些功能非常适合自动化无法像[Netflix](http://blueshirtdesign.com/apps/autoflix/)那样自动化的应用程序。自从我一直在工作中使用Windows以来，这从来都不是什么大不了的事情，但是在过去的几年里，我一直在专门使用Mac。

我喜欢AutoHotkey，但我喜欢Node.js更多。通过开发RobotJS，我在Mac上获得了AutoHotkey的替代品（终于！），并且我可以使用我最喜欢的语言。

**TLDR：**在Mac上没有像AutoHotkey这样的游戏，所以我正在制作它。

## 许可证

麻省理工学院

基于[自动。](https://github.com/msanders/autopy)由[Jason Stallings](http://jason.stallin.gs/)维护。