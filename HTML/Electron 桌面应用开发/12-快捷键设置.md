# globalShortCut 

globalShortCut 模块可以在操作系统中注册全局快捷键,以便可以为操作定制各种快捷键,但是只能在主进程中使用

globalShortCut  主要接收两个参数,分别为注册的快捷键和回调函数

**主进程注册**

```js
 //  此配置文件的修改需要重启app 才能使用修改后的配置
 const {
     app, //引用app
     BrowserWindow, //引用桌面窗口
     net,       //自带请求模块
     globalShortcut,    //快捷键设置模块
 } = require('electron')
 
 app.on('will-quit',()=>{        //当所有窗口已关闭并且应用程序都已经退出时发出
    // globalShortcut.unregister('CommandOrControl+E') //注销单个快捷键
    globalShortcut.unregisterAll()  //注销所有快捷键
})


// 主进程下注册快捷键
//  等同于 app.whenReady().then(createWindow)
 app.on('ready', () => { //生命周期函数,监听窗口准备
    // 在初始化的时候注册全局快捷键
    // 缺点:只能在应用程序被聚焦时触发（焦点在程序上，不只是显示），由于win一般不使用菜单，故只能用于mac上。
    const ret=globalShortcut.register('CommandOrControl+E',()=>{
        // Command linux  下
        // Control window 下
        // CommandOrControl+E 或 CommandOrControl+e 都可以,不区分大小写
        console.log('使用快捷键ctrl+e1111');
    })
    if(!ret){
        console.log('注册失败!');
    }

     mainWindow = new BrowserWindow({
         width: 1300, //窗口的宽
         height: 600, //窗口的高
         webPreferences: {
             nodeIntegration: true, //允许所有的node 库运行,不写的话node 相关的库就无法使用,是否完整支持node. 默认为 true.
             contextIsolation: false, //同上一起配置,窗口的环境隔离
             enableRemoteModule: true, //允许使用多窗口
             webviewTag: true, //允许在html 上使用webview 标签(即使html 支持webview 标签),不设置webview 没有效果
         }
     })
     mainWindow.loadFile('index.html') //加载应用的界面
     mainWindow.on('closed', () => { //监听窗口的关闭
         console.log('窗口关闭');
         mainWindow = null //销毁程序,否则每次打开都会生成占用内存空间
     })
     mainWindow.webContents.openDevTools(); //打开调试工具
 })


```

**渲染进程中注册**

目前好像无效

```html

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文件拖动</title>
    <style>
        .wv {
            width: 640px;
            height: 480px;
        }
    </style>
</head>

<body>
    <!-- 渲染进程中使用快捷键 -->
    <script>
        // electron 10下，remote模块默认关闭， 必须手动设置webPreferences中的enableRemoteModule为true之后才能使用
        // const remote = require('electron').remote;   //需要在主进程中的配置允许使用node 模块require
        // console.log(require('electron') );
        // const ret = remote.globalShortcut.register('CommandOrControl+x', () => {
        //     // Command linux  下
        //     // Control window 下
        //     // CommandOrControl+E 或 CommandOrControl+e 都可以,不区分大小写
        //     console.log('渲染进程中使用快捷键ctrl+xxxxxx');
        // })
        // if (!ret) {
        //     console.log('注册失败!1111');
        // }
    </script>
</body>

</html>
```

**替代方案:[Electron菜单与快捷键 - 掘金 (juejin.cn)](https://juejin.cn/post/6968254840275206174)**

```js
渲染进程：
window.addEventListener('keyup', handleKeyPress, true)
function handleKeyPress(event) {
  $message.success(`keyup 监听${event.key}`)
  console.log(`You pressed ${event.key}`)
}
window.removeEventListener('keyup', handleKeyPress, true)


主进程：
win.webContents.on('before-input-event', (event, input) => {
  if (input.control && input.key.toLowerCase() === 'i') {
    console.log('Pressed Control+I')
    event.preventDefault()
  }
})

```

**或使用node插件库**

```js
npm i mousetrap

渲染进程：

Mousetrap.bind('ctrl+k', function() { 
  $message.success(`Mousetrap ctrl+k`)
})

Mousetrap.unbind('ctrl+k')

```

