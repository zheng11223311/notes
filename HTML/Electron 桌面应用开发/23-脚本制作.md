# 23,24 文章中脚本安装失败!无法使用

# Nodejs使用robotjs轻松控制鼠标键盘

最近刚完成了基于vue的聊天系统的开发，闲下来之余，鼓捣了一下node脚本，每天上班开机挺麻烦，要一个一个打开软件、手动连wifi；于是乎，鼓捣出了一个很简单的自动执行脚本，执行 node 该文件名.js后，自动联网打开各种软件；

**本例首先安装 npm i robotjs 和 npm i opn （opn与控制鼠标键盘无关）**

```

npm i robotjs 
npm i opn
```

简单的代码如下（npm安装好依赖后，以下代码可直接复制执行）：

```js
const opn = require('opn');     //执行语句
var robot = require("robotjs");   //控制鼠标键盘等操作

var screenSize = robot.getScreenSize();
robot.moveMouseSmooth(screenSize.width-140, screenSize.height-20);	//移动鼠标
robot.setMouseDelay(1000)	
robot.mouseClick();	 //鼠标点击
robot.moveMouseSmooth(screenSize.width-140, screenSize.height-560);
robot.setMouseDelay(2000)
robot.mouseClick()
robot.moveMouseSmooth(screenSize.width-140, screenSize.height-490);
robot.setMouseDelay(1000)
robot.mouseClick()

opn('C:/Users/seagm/Desktop/小白入门手册.txt');	//自动打开程序（文件地址自己修改即可）
opn('C:/Users/seagm/Desktop/GitHub Desktop')
opn('C:/Users/seagm/Desktop/Visual Studio Code')
opn('', {app: 'chrome'});
setTimeout(()=>{opn('C:/Program Files (x86)/Tencent/WeChat/WeChat.exe')},2000)
```


**有4个重点：**

引入opn，也可直接使用node自带的child_process；用来执行操作文件的语句
引入robotjs，一个专门做nodejs桌面自动化的库ROBOT官网直达
留意操作文件的URL参数的斜杠方向
如果安装robotjs报错，以管理员身份执行 npm install --global --production windows-build-tools，再 npm i robotjs

```
npm install --global --production windows-build-tools
npm i robotjs
```

当然想更牛的话可以写个开机自动执行该文件，不用再 node 文件名.js 了，这里抛砖引玉，一个自动化小栗子来帮助不大懂robotjs的伙伴们，robotjs具体的api可见上面的官网直达。。。
从此我每天又节省了30秒了，哈哈
————————————————
版权声明：本文为CSDN博主「楠辞琦咎」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。
原文链接：https://blog.csdn.net/qq_34995862/article/details/106501587

