## 删除视频评论-接口实现

#### 路由新增

```js
  // 删除视频评论-接口实现
  router.delete('/videos/:videoId/comments/:commentId', auth, controller.video.deleteVideoComments);
```



#### video.js 新增

```js
  async deleteVideoComments() {
    const { Comment, Video } = this.app.model;
    const { videoId, commentId } = this.ctx.params;

    // 校验视频是否存在
    const video = await Video.findById(videoId);
    if (!video) {
      this.ctx.throw(404, 'Video Not Found');
    }

    const comment = await Comment.findById(commentId);

    // 检验评论是否存在
    if (!comment) {
      this.ctx.throw(404, 'Commnet Not Found');
    }

    // 校验当前评论作者是否是当前登入用户
    if (!comment.user.equals(this.ctx.user._id)) {
      this.ctx.throw(403);
    }

    // 删除视频评论
    await comment.remove();

    // 更新视频的评论数量
    video.commentCount = await Comment.countDocuments({
      video: videoId,
    });

    await video.save();

    this.ctx.status = 204;
  }
```

