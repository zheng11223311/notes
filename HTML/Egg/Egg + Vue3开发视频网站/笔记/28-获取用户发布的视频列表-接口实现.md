## 获取用户发布的视频列表-接口实现

#### 路由新增

```js
  // 获取用户发布的视频列表-接口实现
  router.get('/users/:userId/videos', controller.video.getUserVideos);
```



#### 控制器新增

```js
  async getUserVideos() {
    const { Video } = this.app.model;
    let { pageNum = 1, pageSize = 10 } = this.ctx.query;
    const userId = this.ctx.params.userId;
    pageNum = Number.parseInt(pageNum);
    pageSize = Number.parseInt(pageSize);
    console.log(pageNum, pageSize);
    const getvideos = Video.find({
      user: userId,
    }).populate('user').sort({
      createAt: -1,
    })
      .skip((pageNum - 1) * pageSize)
      .limit(pageSize);

    const getvideosCount = Video.countDocuments({
      user: userId,
    }); // 数据总数量
    const [ videos, videosCount ] = await Promise.all([
      getvideos,
      getvideosCount,
    ]);
    this.ctx.body = {
      videos,
      videosCount,
    };
  }
```

