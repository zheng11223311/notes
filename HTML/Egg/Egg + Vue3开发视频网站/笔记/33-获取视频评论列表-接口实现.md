## 获取视频评论列表-接口实现

#### 路由新增

```js
// 获取视频评论列表-接口实现
router.get('/videos/:videoId/comments',controller.video.getVideoComments);
```



#### video.js 控制器新增

```js
  async getVideoComments() {
    const { Comment } = this.app.model;
    let { pageNum = 1, pageSize = 10 } = this.ctx.query;
    const { videoId } = this.ctx.params;
    pageNum = Number.parseInt(pageNum);
    pageSize = Number.parseInt(pageSize);

    const getComments = Comment.find({
      video: videoId,
    })
      .skip((pageNum - 1) * pageSize)
      .limit(pageSize)
      .populate('user')
      .populate('video');

    const getCommentsCount = Comment.countDocuments({
      video: videoId,
    }); // 数据总数量
    const [ comments, commentsCount ] = await Promise.all([
      getComments,
      getCommentsCount,
    ]);
    this.ctx.body = {
      comments,
      commentsCount,
    };
  }
```

