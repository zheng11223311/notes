### 1.脚本引擎控制方法

地址:[脚本引擎 - Engines (autojs.org)](https://pro.autojs.org/docs/#/zh-cn/engines?id=enginesstopall)

## [engines.stopAll()](https://pro.autojs.org/docs/#/zh-cn/engines?id=enginesstopall)

停止所有正在运行的脚本。包括当前脚本自身。

## [engines.stopAllAndToast()](https://pro.autojs.org/docs/#/zh-cn/engines?id=enginesstopallandtoast)

停止所有正在运行的脚本并显示停止的脚本数量。包括当前脚本自身。

## [engines.myEngine()](https://pro.autojs.org/docs/#/zh-cn/engines?id=enginesmyengine)

返回当前脚本的脚本引擎对象([ScriptEngine](https://pro.autojs.org/docs/#/zh-cn/engines?id=engines%3fid))

**[v4.1.0新增]** 特别的，该对象可以通过`execArgv`来获取他的运行参数，包括外部参数、intent等。例如：

```
log(engines.myEngine().execArgv);
```

普通脚本的运行参数通常为空，通过定时任务的广播启动的则可以获取到启动的intent。

## [engines.all()](https://pro.autojs.org/docs/#/zh-cn/engines?id=enginesall)

- 返回 {Array}

返回当前所有正在运行的脚本的脚本引擎[ScriptEngine](https://pro.autojs.org/docs/#/zh-cn/engines?id=engines_scriptengine)的数组。

```
log(engines.all());
```

**脚本引擎对象**

scriptEngine:engines.myEngine()  和 engines.all()  获取脚本引擎,返回的是引擎对象

**脚本执行对象**

scriptExection:执行录制文件,执行导入文件和字符串的js,都是返回执行对象

# [ScriptExecution](https://pro.autojs.org/docs/#/zh-cn/engines?id=scriptexecution)

执行脚本时返回的对象，可以通过他获取执行的引擎、配置等，也可以停止这个执行。

要停止这个脚本的执行，使用`execution.getEngine().forceStop()`.

## [ScriptExecution.getEngine()](https://pro.autojs.org/docs/#/zh-cn/engines?id=scriptexecutiongetengine)

返回执行该脚本的脚本引擎对象([ScriptEngine](https://pro.autojs.org/docs/#/zh-cn/engines?id=engines%3fid))

## [ScriptExecution.getConfig()](https://pro.autojs.org/docs/#/zh-cn/engines?id=scriptexecutiongetconfig)

返回该脚本的运行配置([ScriptConfig](https://pro.autojs.org/docs/#/zh-cn/engines?id=engines%3fid))

# [ScriptEngine](https://pro.autojs.org/docs/#/zh-cn/engines?id=scriptengine)

脚本引擎对象。

## [ScriptEngine.forceStop()](https://pro.autojs.org/docs/#/zh-cn/engines?id=scriptengineforcestop)

停止脚本引擎的执行。

## [ScriptEngine.cwd()](https://pro.autojs.org/docs/#/zh-cn/engines?id=scriptenginecwd)

- 返回 {string}

返回脚本执行的路径。对于一个脚本文件而言为这个脚本所在的文件夹；对于其他脚本，例如字符串脚本，则为`null`或者执行时的设置值。

## [ScriptEngine.getSource()](https://pro.autojs.org/docs/#/zh-cn/engines?id=scriptenginegetsource)

- 返回 [ScriptSource](https://pro.autojs.org/docs/#/zh-cn/engines?id=engines_scriptsource)

返回当前脚本引擎正在执行的脚本对象。

```
log(engines.myEngine().getSource());
```

## [ScriptEngine.emit(eventName[, ...args\])](https://pro.autojs.org/docs/#/zh-cn/engines?id=scriptengineemiteventname-args)

- `eventName` {string} 事件名称
- `...args` {any} 事件参数

向该脚本引擎发送一个事件，该事件可以在该脚本引擎对应的脚本的events模块监听到并在脚本主线程执行事件处理。

例如脚本receiver.js的内容如下：

```
//监听say事件
events.on("say", function(words){
    toastLog(words);
});
//保持脚本运行
setInterval(()=>{}, 1000);
```

同一目录另一脚本可以启动他并发送该事件：

```
//运行脚本
var e = engines.execScriptFile("./receiver.js");
//等待脚本启动
sleep(2000);
//向该脚本发送事件
e.getEngine().emit("say", "你好");
```

# [ScriptConfig](https://pro.autojs.org/docs/#/zh-cn/engines?id=scriptconfig)

脚本执行时的配置。

## [delay](https://pro.autojs.org/docs/#/zh-cn/engines?id=delay)

- {number}

延迟执行的毫秒数

## [interval](https://pro.autojs.org/docs/#/zh-cn/engines?id=interval)

- {number}

循环运行时两次运行之间的时间间隔

## [loopTimes](https://pro.autojs.org/docs/#/zh-cn/engines?id=looptimes)

- {number}

循环运行次数

## [getPath()](https://pro.autojs.org/docs/#/zh-cn/engines?id=getpath)

- 返回 {Array}

返回一个字符串数组表示脚本运行时模块寻找的路径。

**示例:**

```js


// engines.execScript('a','sleep(50000)')

// sleep(3000)  //如果没有延迟时间,不会捕捉到a 的运行,a 不会被停止
// 在开发工具中可以看到,a.js 正在运行,没有被停止
// engines.stopAllAndToast()  //停止所有脚本并提示



// console.log(engines.myEngine());  //返回当前脚本引擎对象
// ScriptEngine@e494198{id=451,source='[remote]28-脚本引擎控制方法.js',cwd='/storage/emulated/0/脚本'}


console.log(engines.all());  //返回一个数组,包含所有对象
// [ ScriptEngine@a0cd1e{id=452,source='[remote]28-脚本引擎控制方法.js',cwd='/storage/emulated/0/脚本'} ]



// 停止所有脚本引擎,包括这个运行的文件
// engines.stopAll()
// sleep 不会被运行,因为被停止了
sleep(5000)





toast('我是文件')
```

 