### 1.图片回收机制(防内存泄漏)

地址:[图片与颜色 - Images (autojs.org)](https://pro.autojs.org/docs/#/zh-cn/images?id=images)

# [Images](https://pro.autojs.org/docs/#/zh-cn/images?id=images)

images模块提供了一些手机设备中常见的图片处理函数，包括截图、读写图片、图片剪裁、旋转、二值化、找色找图等。

该模块分为两个部分，找图找色部分和图片处理部分。

需要注意的是，image对象创建后尽量在不使用时进行回收，同时避免循环创建大量图片。因为图片是一种占用内存比较大的资源，尽管Auto.js通过各种方式（比如图片缓存机制、垃圾回收时回收图片、脚本结束时回收所有图片）尽量降低图片资源的泄漏和内存占用，但是糟糕的代码仍然可以占用大量内存。

Image对象通过调用`recycle()`函数来回收。例如：

```
// 读取图片
var img = images.read("./1.png");
// 对图片进行操作
... 
// 回收图片
img.recycle();
```

例外的是，`captureScreen()`(截图)返回的图片不需要回收。

## [图片处理](https://pro.autojs.org/docs/#/zh-cn/images?id=图片处理)

## [images.read(path)](https://pro.autojs.org/docs/#/zh-cn/images?id=imagesreadpath)

- `path` {string} 图片路径

读取在路径path的图片文件并返回一个Image对象。如果文件不存在或者文件无法解码则返回null。

## [images.load(url)](https://pro.autojs.org/docs/#/zh-cn/images?id=imagesloadurl)

- `url` {string} 图片URL地址

加载在地址URL的网络图片并返回一个Image对象。如果地址不存在或者图片无法解码则返回null。

## [images.copy(img)](https://pro.autojs.org/docs/#/zh-cn/images?id=imagescopyimg)

- `img` {Image} 图片
- 返回 {Image}

复制一张图片并返回新的副本。该函数会完全复制img对象的数据。

```js
// 这里读取的是手机的图片,不是计算机的图片
// var img = images.read("/storage/emulated/0/1.jpeg");
// log(img)
// img.recycle();
//获取不到图片可能是
// 模拟器桥接错误,浏览器没有网络搜索,但是哔哩哔哩可以正常使用
// 桥接选择桥接有wifi 字样的选项
// 图片地址错误
// var img1 = images.load("https://images.pexels.com/photos/10023915/pexels-photo-10023915.jpeg");
// log(img1)
// 保存图片
// img1.saveTo('/storage/emulated/0/1.jpeg')  //保存在根目录下,并命名为1.jpeg
// img1.recycle();

var img = images.read("/storage/emulated/0/1.jpeg");
// var img1=images.copy(img)  copy 图片的数据流,保存时需要填写完整的路径
img1.saveTo('/storage/emulated/0/2.jpeg')
img1.recycle();
img.recycle();
```

