### 1.脚本引擎之间的通信

地址:[脚本引擎 - Engines (autojs.org)](https://pro.autojs.org/docs/#/zh-cn/engines?id=scriptengineemiteventname-args)

## [ScriptEngine.emit(eventName[, ...args\])](https://pro.autojs.org/docs/#/zh-cn/engines?id=scriptengineemiteventname-args)

- `eventName` {string} 事件名称
- `...args` {any} 事件参数

向该脚本引擎发送一个事件，该事件可以在该脚本引擎对应的脚本的events模块监听到并在脚本主线程执行事件处理。

例如脚本receiver.js的内容如下：

```
//监听say事件
events.on("say", function(words){
    toastLog(words);
});
//保持脚本运行
setInterval(()=>{}, 1000);
```

同一目录另一脚本可以启动他并发送该事件：

```
//运行脚本
var e = engines.execScriptFile("./receiver.js");
//等待脚本启动
sleep(2000);
//向该脚本发送事件
e.getEngine().emit("say", "你好");
```

**示例:**

```js
// 脚本引擎执行时会有弹出,卡顿现象,这是bug
var executionObject =engines.execScriptFile('/sdcard/脚本/42-emit.js',{
    delay:0, //延迟
    // loopTimes:3,   //循环次数,0为无限
    // interval:2000,  //两次输出间隔时间
})
sleep(1500)

//获取脚本引擎对象
var engineObject=executionObject.getEngine()

// 发射事件
engineObject.emit('fun',"参数1","参数2")
toast('启动服务器') 
```

**42-emit.js**

```js
// 接收发射的事件
events.on("fun",function(arg1,arg2) {
    toastLog(arg1+''+arg2)
})

// 保持脚运行
setInterval(()=>{},1000)

toast('启动服务器') 
```

