<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="../js/vue.js"></script>
</head>

<body>
    父组件
    <div id="app">
        父组件访问子组件:使用$children 或$refs => reference(引用)
        子组件访问父组件:使用$parent

        this.$children 是一个数组类型,它包含所有子组件对象
        我们这里通过一个遍历,取出所有子组件的message 状态
        <cpn></cpn> 单标签下无法显示其他标签,不建议使用
        <cpn ref='aaa'></cpn>
        <button @click='btnClick'>按钮</button>
    </div>


    <template id="cpn">
        <div> 组件必须有一个根元素

        </div>

    </template>

</body>
<script>
    const app = new Vue({
        el: '#app',
        data: {

        },
        components: {
            cpn: {
                template: '#cpn',
                props: {

                },
                data() {
                    return {
                        name: '我是子组件的name'
                    }
                },
                methods: {
                    showMessage() {
                        console.log('showMessage');
                    }
                },
                // watch 是组件内的属性,用于监听属性的改变
                watch: {
                    // 监听props 里的name 属性的改变
                    // name(newValue[, oldValue])
                    name(newValue) {
                        // 属性改变的会到这里
                    },
                    // 监听子组件的事件
                    // dnumber1(newValue) {
                    //     this.dnumber2 = newValue * 100
                    //     this.$emit('num1change', newValue)
                    // },
                    // dnumber2(newValue) {
                    //     this.dnumber1 = newValue / 100
                    //     this.$emit('num2change', newValue)
                    // }
                }
            }
        },
        methods: {
            btnClick() {
                //1.$children 获取下标,当中间插入新增cpn 组件时
                // 必须改变下标才能获取当前组件

                // console.log(this.$children);    //[VueComponent, VueComponent]
                // VueComponent 是子组件
                // for (let c of this.$children) {
                //     console.log(c.name);
                //     c.showMessage()
                // }
                // this.$children[0].showMessage()
                // this.$children[0].name

                // 2.$refs==>是{} 类型  相当于标签的class
                // console.log(this.$refs);    //{}
                // cpn 组件上加了ref='aaa'
                // console.log(this.$refs);    //{aaa: VueComponent}
                // 取到aaa
                console.log(this.$refs.aaa);    //VueComponent {_uid: 2, _isVue: true, $options: {…}, _renderProxy: Proxy, _self: VueComponent, …}
                // 拿到aaa 里面的name
                console.log(this.$refs.aaa.name);   //我是子组件的name
            }
        }
    })




























    //从新敲一遍代码
    // 子组件
    // const cpn = {
    // template: '#cpn2',
    // props:{}   //两者都可以 很多中其他的写法  string boolean...
    // props:['childmovies','cmessage'],
    // props: {
    //1.类型的限制
    // childmovies:Array,
    // cmessage:String     //String 大写..

    // 2.提供一些默认值,以及必传值
    // cmessage: {
    //     type: String,
    //     default: 'aaa',   //没有传值默认值
    //     required: true    //布尔变量,必须向这个值传入值,不传报错 required 必须

    // },
    // childmovies: {
    //     // type:Array,      一种报错?
    //     //Object Array String Number Boolean Date Function Symbol
    //     type: [Array, String],    //两种类型
    //     //default 类型是对象或则数组时,默认值必须是一个函数
    //     // default:[], //在vue2.5.3 以下不会报错
    //     default() {
    //         return []
    //     },

    //     // 自定义验证类型(自己定义),不匹配则报错
    //     zdy(value) {
    //         return ['a', 'b'].indexOf(value) !== -1
    //     }
    // }
    //     },
    //     data() {
    //         return {

    //         }
    //     },
    //     methods: {
    //         btnClick(item) {

    //             this.$emit('itemclick', item)
    //         }
    //     }

    // }

    // 父组件
    // const app = new Vue({   //开发中一般只使用一个app
    //     el: '#app',     //挂载元素
    //     data: {

    //     },
    //     computed: {   // computed 里面的函数只打印一次

    //     },
    //     methods: {  // methods 里面的函数打印多次

    //     },
    //     //过滤器 filters
    //     filters: {

    //     },
    //     components: {    //注册局部组件
    //         cpn         //ES6字面量属性增强写法  原式  cpn:cpn
    //     }
    // })

</script>
<!-- 报错 -->
<!-- Duplicate keys detected: 'aa'. This may cause an update error -->
<!-- 绑定key的元素中     aaa 的 key 值多次重复添加  不绑定就不会报错-->

<!-- [Vue warn]: Avoid mutating a prop directly since the value 
will be overwritten whenever the parent component re-renders.
Instead, use a data or computed property based on the prop's value.
 Prop being mutated: "number1" -->

<!-- 组件里props 属性必须通过父组件来修改 -->

</html>