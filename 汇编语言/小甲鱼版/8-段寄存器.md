### 1.段寄存器

段寄存器就是提供段地址的

8086 CPU 有4个段寄存器:

CS(CodeSection 代码段) , DS (DataSection 数据段), SS(StackSection 堆栈段) , ES( ExtraSection 附加段)

当8086CPU 要访问内存单元时,由这4个段寄存器提供内存单元的段地址

### 2.CS 和IP

CS 和IP 是8086 CPU 中最关键的寄存器,他们指示了CPU 当前要读取指令的地址

CS 为代码段寄存器

IP 为指令指针寄存器

### 3.8086PC过程的简单描述

1. 从CS :IP 指向内存单元读取指令,读取的指令进入指令缓冲器
2. IP=IP+所有读取指令的长度,从而指向下一条指令
3. 执行指令,转到步骤1,重复这个过程

> 在8086CPU 加电启动或复位后(即CPU 刚开始工作时)CS 和IP 被设置为CS =FFFFH,IP =0000H
>
> 即在8086 PC 机刚启动时,CPU 从内存FFFF0H 单元中读取指令执行
>
> FFFF0H 单元中的指令是8086PC 机开机后执行的第一条指令

> 在任何时候,CPU 将CS , IP 中的内容当作指令的段地址和偏移地址,用它们合成指令的物理地址,到内存中读取指令码,执行
>
> 如果说,内存中的一段信息曾被CPU 执行过的话,那么,它所在的内存单元必然被CS:IP 指向过

### 4.修改CS,IP 的指令

在CPU 中,程序员能够用指令读写的部件只有寄存器,程序员可以通过改变寄存器中的内容实现对CPU 的控制

CPU 从何处执行指令是由CS ,IP 中的内容决定的,程序员可以通过改变CS, IP 中的内容来控制CPU 执行目标指令

**mov 指令**

mov 指令可以改变8086CPU 大部分寄存器的值,被称为传送指令

**mov 指令不能用于设置CS,IP 的值,8086CPU 没有提供这样的功能**

8086CPU 为CS,IP 提供了另外的指令来改变它们的值:**转移指令**

**转移指令**

- 同时修改CS,IP 的内容:

  - jmp 段地址 :偏移地址

  - ```
    jmp 2AE3:3
    jmp 3:0B16    //3 为 0003
    ```

  - 功能:

  - 用于指令中给出的段地址修改CS,偏移地址修改IP

  

  **仅修改IP 的内容**

  jmp 某一合法寄存器

  jmp ax (类似于mov IP,ax)

  jmp bx

  功能:用寄存器中的值修改IP

  ### 5.代码段

  - 对于8086PC 机,在编程时,可以根据需要,将一组内存单元定义为一个段
  - 可以将长度为N (N<=64KB) 的一组代码,存在一组地址连续,起始地址为16的倍数的内存单元中,这段内存是用来存放代码的,从而定义了一个代码段

  **例如**

  ```
  mov ax,0000      (B8 00 00)  //2个16为进制表示一个字节
  add ax,0123		 (05 23 01)
  mov bx,ax   	 (8F,D8)
  jmp bx			(FF E3)
  ```

  这段长度为10 字节的指令,存在从123B0H~123B9H 的一组内存单元中,我们就可以认为,123B0H~123B9H 这段内存单元是用来存放代码的,是一个代码段,它的段地址为123BH,长度为10 字节

  **如何使得代码段中的指令被执行呢?**

  将一段内存当作代码段,仅仅是我们在编程时的一种安排,CPU 并不会由于这种安排,就自动地将我们定义的代码段中的指令当作指令来执行

  **CPU 只认被CS:IP 指向的内存单元中的内容为指令**

  所以要将CS:IP 指向所定义的代码段中的第一条指令的首地址

  ```
  mov ax,0000      (B8 00 00)  //要指向这一条地址,如果指向下面一个指令地址,这个就会被忽略
  add ax,0123		 (05 23 01)
  mov bx,ax   	 (8F,D8)
  jmp bx			(FF E3)
  ```

  所以在破解时,如果有注册指令和内容指令时,我们可以跳过注册指令,直接指向内容指令

  **小结:**

  - 段地址在8086CPU 的寄存器中存放,当8086CPU 要访问内存时,由段寄存器提供内存单元的段地址,8086CPU 有4个寄存器,其中CS 用来存放指令的段地址
  - CS 用来存放指令的段地址,IP 存放指令的偏移地址
  - 8086 机中,任意时刻,CPU 将CS:IP 指向的内容当作指令执行
  - 8086CUP 的工作过程:
    - 从CS:IP 指向内存单元读取指令,读取的指令进入指令缓冲器
    - IP 指向下一条指令, IP=IP +当前指令字节长度
    - 执行指令(转到步骤1,重复这个过程)
  - 8086CPU 提供转移指令修改CS:IP 的内容

  

  

  

  

  

  

  

  

  

